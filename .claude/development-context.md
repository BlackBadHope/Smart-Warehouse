# Inventory OS - Development Context & Key Decisions

## –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ß–∏—Ç–∞—Ç—å –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏! üö®

### –§–∏–ª–æ—Å–æ—Ñ–∏—è –ø—Ä–æ–µ–∫—Ç–∞
**"–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è —É–∂–µ –ø—Ä–∏–¥—É–º–∞–Ω—ã –∫–µ–º-—Ç–æ"** - –∏–∑—É—á–∞–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ä–µ—à–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –∏–∑–æ–±—Ä–µ—Ç–µ–Ω–∏—è –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞.

### –†–µ–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- **–ù–ï "—Å–µ–º–µ–π–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"** - —ç—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–∞–ª–æ–≥–∏–∑–∞—Ü–∏–∏
- **–î–µ–≤–∏–∑**: "–ö–ê–¢–ê–õ–û–ì–ò–ó–ò–†–£–ô –í–°–ï–õ–ï–ù–ù–£–Æ" 
- **–¶–µ–ª—å**: –ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –≤—Å–µ—Ö –≤–µ—â–µ–π —Å –ò–ò —Å–æ–≤–µ—Ç–∞–º–∏ –∏ –±—É–¥—É—â–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π (—É–º–Ω—ã–π –¥–æ–º, IoT, VR/AR)
- **–ú–∞—Å—à—Ç–∞–±**: –û—Ç –ª–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–æ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –Ω–∞ 100-100000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –¢–µ–∫—É—â–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ç—É—Å

#### –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- **–¢–µ–∫—É—â–∞—è**: React + TypeScript + Vite + Capacitor
- **–ü—Ä–æ–±–ª–µ–º–∞**: Capacitor –ù–ï –ú–û–ñ–ï–¢ —Å–æ–∑–¥–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω—ã–π HTTP —Å–µ—Ä–≤–µ—Ä –Ω–∞ Android
- **–†–µ—à–µ–Ω–∏–µ**: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Flutter (–∫–∞–∫ LocalSend)

#### P2P Evolution (4 –ø–æ–ø—ã—Ç–∫–∏):
1. `simpleP2PService.ts` - BroadcastChannel (—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ)
2. `simpleQRP2PService.ts` - WebRTC –±–µ–∑ STUN (—Å–ª–æ–∂–Ω–æ, –Ω–µ–Ω–∞–¥–µ–∂–Ω–æ)
3. `localSendStyleService.ts` - Service Worker HTTP —Å–∏–º—É–ª—è—Ü–∏—è (–±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –∫–æ—Å—Ç—ã–ª—å)
4. `nativeLocalSendService.ts` - Capacitor HTTP –ø–æ–ø—ã—Ç–∫–∞ (failed to start server –Ω–∞ Android)

#### –ü–æ—Å–ª–µ–¥–Ω–∏–π APK
`inventory-os-v2.6-native-localsend.apk` - —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –Ω–∞ Capacitor

### LocalSend –∫–∞–∫ —ç—Ç–∞–ª–æ–Ω

#### –ü–æ—á–µ–º—É LocalSend?
- **–î–æ–∫–∞–∑–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ**: –º–∏–ª–ª–∏–æ–Ω—ã –∑–∞–≥—Ä—É–∑–æ–∫, —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ P2P –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
- **–¢–µ—Ö—Å—Ç–µ–∫**: Flutter + dart:io HttpServer + multicast_dns
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ù–∞—Ç–∏–≤–Ω—ã–π HTTP —Å–µ—Ä–≤–µ—Ä, –∞–≤—Ç–æ–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å

#### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã LocalSend:
1. dart:io HttpServer –Ω–∞ —Å–ª—É—á–∞–π–Ω–æ–º –ø–æ—Ä—Ç—É
2. Multicast UDP –æ–±—ä—è–≤–ª–µ–Ω–∏–µ (224.0.0.167:53317)
3. mDNS discovery –¥–ª—è –ø–æ–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
4. HTTP POST –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
5. TLS —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

#### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (Data Conflict Resolution)
**Hybrid –ø–æ–¥—Ö–æ–¥**:
1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ items** ‚Üí CRDT (UUID + timestamp, –æ–±–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è)
2. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö** ‚Üí Role + Timestamp priority
3. **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** ‚Üí Manual resolution

#### –°–∏—Å—Ç–µ–º–∞ "–í–∑—è—Ç–æ –≤ —Ä–∞–±–æ—Ç—É" (Item Locking) üîí
**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø —Ñ—É–Ω–∫—Ü–∏—è** –¥–ª—è collaborative editing:

```typescript
enum ItemState {
  AVAILABLE = 'available',      // –°–≤–æ–±–æ–¥–µ–Ω
  LOCKED = 'locked',           // –í–∑—è—Ç –≤ —Ä–∞–±–æ—Ç—É  
  PHANTOM = 'phantom',         // –§–∞–Ω—Ç–æ–º (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–¥–µ –±—ã–ª)
  TRASH_PENDING = 'trash_pending'  // –û–∂–∏–¥–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏—è
}
```

**Workflow**:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–µ—Ä–µ—Ç –ø—Ä–µ–¥–º–µ—Ç ‚Üí item –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
2. –î—Ä—É–≥–∏–µ –≤–∏–¥—è—Ç —Ñ–∞–Ω—Ç–æ–º: "üîí –í–∑—è—Ç–æ –≤ —Ä–∞–±–æ—Ç—É: UserA ‚è∞ –û—Å—Ç–∞–ª–æ—Å—å: 12 –º–∏–Ω"
3. –§–∞–Ω—Ç–æ–º –Ω–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∏–∫–æ–º—É –∫—Ä–æ–º–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞ lock'–∞
4. –¢–∞–π–º–µ—Ä 15 –º–∏–Ω—É—Ç ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ Trash ‚Üí —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞

### –Ø–∑—ã–∫–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: Ukrainian (–≤–æ–π–Ω–∞ —Å –†–æ—Å—Å–∏–µ–π, –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- **–†—É—Å—Å–∫–∏–π**: –ö–∞–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –Ω–æ –ù–ï –∫–∞–∫ –≤–∞–ª—é—Ç–∞
- **–ò–∑–±–µ–≥–∞—Ç—å**: –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏ —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ –∏–∑-–∑–∞ —Ç–µ–∫—É—â–∏—Ö —Å–æ–±—ã—Ç–∏–π

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

#### Capacitor –ø—Ä–æ–±–ª–µ–º—ã:
- –ë—É—Ñ–µ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ APK –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ (WebView initialization)
- –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è React + —Å–µ—Ä–≤–∏—Å–æ–≤
- localStorage –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ Android –º–µ–¥–ª–µ–Ω–Ω–µ–µ
- –ö–Ω–æ–ø–∫–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã –ø–æ–∫–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∞—Ç—Å—è useEffect —Ö—É–∫–∏

#### Flutter –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- –ù–∞—Ç–∏–≤–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è ‚Üí –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç
- –ù–∞—Å—Ç–æ—è—â–∏–π HTTP —Å–µ—Ä–≤–µ—Ä (dart:io)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ WebView overhead
- –ï–¥–∏–Ω—ã–π –∫–æ–¥ –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (—á—Ç–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å –≤ Flutter)

#### Core:
- Multi-level organization (Warehouses‚ÜíRooms‚ÜíShelves‚ÜíItems)
- Offline-first —Å localStorage
- Multi-currency & multi-language
- Import/Export (JSON, CSV)
- User management —Å role-based access
- Trash management —Å soft delete

#### AI Integration:
- Multiple providers (Claude, OpenAI, Local LLM)
- Chat interface –¥–ª—è natural language queries
- Barcode scanning
- Smart recommendations

#### P2P Features:
- QR code pairing (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –¥–æ 3 –∫–Ω–æ–ø–æ–∫)
- Network discovery simulation
- Conflict resolution
- SimpleQRModal —Å —Ä–µ–∞–ª—å–Ω—ã–º QR —Å–∫–∞–Ω–µ—Ä–æ–º (qr-scanner lib)

### –û—à–∏–±–∫–∏ –∫–æ—Ç–æ—Ä—ã—Ö –∏–∑–±–µ–≥–∞—Ç—å

#### ‚ùå –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è –±–µ–∑ –∏–∑—É—á–µ–Ω–∏—è –∞–Ω–∞–ª–æ–≥–æ–≤
2. –ö–æ—Å—Ç—ã–ª–∏ –≤–º–µ—Å—Ç–æ —Å–º–µ–Ω—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã  
3. Service Worker –∫–∞–∫ HTTP —Å–µ—Ä–≤–µ—Ä
4. WebRTC –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á
5. "–°–µ–º–µ–π–Ω–æ–µ" –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ

#### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:
1. –ò–∑—É—á–µ–Ω–∏–µ LocalSend –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º
2. Flutter + dart:io –¥–ª—è –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ networking
3. CRDT + Role-based conflict resolution
4. Item locking —Å–∏—Å—Ç–µ–º–∞
5. –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–æ–¥–∞—á–∞ –ø—Ä–æ–µ–∫—Ç–∞

### Flutter Migration Plan

#### Phase 1: Platform Migration
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Flutter SDK
- `flutter create inventory_os_flutter`
- –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å UI (React ‚Üí Flutter widgets)
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å dart:io HttpServer
- –î–æ–±–∞–≤–∏—Ç—å multicast_dns –¥–ª—è discovery

#### Key Packages:
```yaml
dependencies:
  mobile_scanner: ^4.0.1      # QR —Å–∫–∞–Ω–µ—Ä
  multicast_dns: ^0.3.2       # Device discovery  
  http: ^1.1.0                 # HTTP –∫–ª–∏–µ–Ω—Ç
  # dart:io –≤—Å—Ç—Ä–æ–µ–Ω –¥–ª—è HTTP —Å–µ—Ä–≤–µ—Ä–∞
```

#### Phase 2-4: Enhanced features
- AI integration —É–ª—É—á—à–µ–Ω–∏—è
- IoT integration  
- Enterprise scalability
- AR/VR interfaces (–¥–∞–ª–µ–∫–æ–µ –±—É–¥—É—â–µ–µ)

### –ú–∞–Ω—Ç—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞
- "–õ–∏–±–æ –Ω–∞–π–¥–µ–º –∫–∞–∫ —Å–¥–µ–ª–∞–ª –∫—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–π, –ª–∏–±–æ –ø–æ–π–º–µ–º –ø–æ—á–µ–º—É –Ω–∏–∫—Ç–æ —Ç–∞–∫ –Ω–µ –¥–µ–ª–∞–µ—Ç"
- "–ù–µ –∏–∑–æ–±—Ä–µ—Ç–∞–µ–º –≤–µ–ª–æ—Å–∏–ø–µ–¥. –ò–∑—É—á–∞–µ–º —á—É–∂–∏–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥—ã –∏ –¥–µ–ª–∞–µ–º —Å–≤–æ–π –º–æ—Ç–æ—Ü–∏–∫–ª"
- "–ò–∑—É—á–µ–Ω–∏–µ –∞–Ω–∞–ª–æ–≥–æ–≤ —ç–∫–æ–Ω–æ–º–∏—Ç –Ω–µ–¥–µ–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"

---
–ö–æ–Ω—Ç–µ–∫—Å—Ç –Ω–µ –≤–ª–µ–∑, —Ç–æ–∫–µ–Ω—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å, —è –ø—Ä–æ—Å—Ç–æ –≤–Ω–µ—Å—É —Å—é–¥–∞ —Ü–µ–ª–∏–∫–æ–º –∏–¥–µ—é. –í –¥–∞–ª—å–Ω–µ–π—à–µ–º –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π –ø–æ–¥ –±–æ–ª–µ–µ —É–¥–æ–±–Ω—ã–π –¥–ª—è —Ç–µ–±—è –≤–∏–¥ (–ò–ª—å—è)
  üåê –ü–æ SSID (–∏–º–µ–Ω–∏ WiFi)

  interface WarehouseLocationPolicy {
    warehouseId: string;
    allowedSSIDs: string[];          // ["Office-WiFi", "Home-Network"]
    allowedBSSIDs?: string[];        // MAC –∞–¥—Ä–µ—Å–∞ —Ä–æ—É—Ç–µ—Ä–æ–≤ (—Ç–æ—á–Ω–µ–µ)
    allowOffline: boolean;           // –î–æ—Å—Ç—É–ø –±–µ–∑ WiFi
    gracePeriod: number;             // –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è (–º–∏–Ω—É—Ç—ã)
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞
  async function checkWiFiAccess(warehouseId: string): Promise<boolean> {
    const currentSSID = await getCurrentWiFiSSID();
    const policy = getWarehousePolicy(warehouseId);

    return policy.allowedSSIDs.includes(currentSSID) ||
           (policy.allowOffline && isOfflineMode());
  }

  üì± –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å WiFi info:

  - Android (Capacitor): @capacitor-community/wifi plugin
  - Flutter: wifi_info_flutter package
  - –í–µ–±: Navigator.connection API (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ)

  Geo-based Access Control

  üìç –ü–æ GPS –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º

  interface WarehouseGeoPolicy {
    warehouseId: string;
    allowedLocations: GeoFence[];
    accuracy: number;                // –†–∞–¥–∏—É—Å –≤ –º–µ—Ç—Ä–∞—Ö
    requireGPS: boolean;             // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–∫–ª—é—á–µ–Ω–Ω—ã–π GPS
  }

  interface GeoFence {
    latitude: number;
    longitude: number;
    radius: number;                  // –ú–µ—Ç—Ä—ã
    name: string;                    // "Office", "Warehouse A"
  }

  async function checkGeoAccess(warehouseId: string): Promise<boolean> {
    const currentPos = await getCurrentPosition();
    const policy = getWarehouseGeoPolicy(warehouseId);

    return policy.allowedLocations.some(fence =>
      isWithinRadius(currentPos, fence, fence.radius)
    );
  }

  Security Scenarios

  üè¢ Office Warehouse

  const officePolicy: WarehouseLocationPolicy = {
    warehouseId: "office-main",
    allowedSSIDs: ["CompanyWiFi", "CompanyGuest"],
    allowedBSSIDs: ["aa:bb:cc:dd:ee:ff"], // –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ä–æ—É—Ç–µ—Ä
    allowOffline: false,              // –°—Ç—Ä–æ–≥–æ –≤ –æ—Ñ–∏—Å–µ
    gracePeriod: 5                    // 5 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
  };

  üè≠ Warehouse with GPS

  const warehouseGeoPolicy: WarehouseGeoPolicy = {
    warehouseId: "warehouse-1",
    allowedLocations: [
      {
        latitude: 50.4501,
        longitude: 30.5234,
        radius: 100,                  // 100 –º–µ—Ç—Ä–æ–≤
        name: "Main Warehouse"
      }
    ],
    accuracy: 50,
    requireGPS: true
  };

  üè† Home Inventory (Flexible)

  const homePolicy: WarehouseLocationPolicy = {
    warehouseId: "home",
    allowedSSIDs: ["Home-WiFi", "Home-5G"],
    allowOffline: true,               // –ú–æ–∂–Ω–æ –±–µ–∑ WiFi
    gracePeriod: 60                   // –ß–∞—Å —Ä–∞–±–æ—Ç—ã –≤–Ω–µ –¥–æ–º–∞
  };

  UX Implementation

  üö® Access Denied Screen

  function AccessDeniedModal({ reason }: { reason: string }) {
    return (
      <div className="access-denied">
        <h2>üîí –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω</h2>
        <p>{reason}</p>
        {reason.includes('WiFi') && (
          <div>
            <p>–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–π —Å–µ—Ç–∏:</p>
            <ul>{allowedNetworks.map(ssid => <li key={ssid}>{ssid}</li>)}</ul>
          </div>
        )}
        {reason.includes('location') && (
          <p>–ü—Ä–∏–±–ª–∏–∑—å—Ç–µ—Å—å –∫ —Å–∫–ª–∞–¥—É (–≤ —Ä–∞–¥–∏—É—Å–µ {requiredRadius}–º)</p>
        )}
      </div>
    );
  }

  ‚ö†Ô∏è Grace Period Warning

  function GracePeriodWarning({ timeLeft }: { timeLeft: number }) {
    return (
      <div className="warning-banner">
        ‚ö†Ô∏è –í–Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–π –∑–æ–Ω—ã. –î–æ—Å—Ç—É–ø –±—É–¥–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —á–µ—Ä–µ–∑ {timeLeft} –º–∏–Ω.
      </div>
    );
  }

  Privacy Considerations

  üîê Local Storage Only

  - WiFi SSID - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
  - GPS –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã - –ù–ï –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

  üõ°Ô∏è Security Benefits

  - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∫—Ä–∞–∂–∏ –¥–∞–Ω–Ω—ã—Ö - –Ω–µ–ª—å–∑—è –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø —É–¥–∞–ª–µ–Ω–Ω–æ
  - Audit trail - –ª–æ–≥–∏ –ø–æ–ø—ã—Ç–æ–∫ –¥–æ—Å—Ç—É–ø–∞ –≤–Ω–µ –∑–æ–Ω—ã
  - Compliance - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º –ø–æ–ª–∏—Ç–∏–∫–∞–º

  Flutter Implementation

  üì¶ Packages

  dependencies:
    wifi_info_flutter: ^2.0.2    # WiFi info
    geolocator: ^9.0.2           # GPS coordinates
    permission_handler: ^10.4.3  # Permissions

  üîí Access Guard

  class LocationAccessGuard {
    static Future<bool> checkAccess(String warehouseId) async {
      final wifiAccess = await _checkWiFiAccess(warehouseId);
      final geoAccess = await _checkGeoAccess(warehouseId);

      return wifiAccess || geoAccess;
    }
  }

  –í—ã–≤–æ–¥

  –î–∞, —ç—Ç–æ –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω–∞—è security feature!

  –û—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è:
  - –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å–∫–ª–∞–¥–æ–≤ (—Å—Ç—Ä–æ–≥–∏–π WiFi control)
  - –ú–æ–±–∏–ª—å–Ω—ã—Ö –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ–π (GPS –≥–µ–æ–∑–æ–Ω—ã)
  - –î–æ–º–∞—à–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (flexible WiFi)

  –î–æ–±–∞–≤–∏—Ç—å –≤ development-context.md –∫–∞–∫ Phase 2 security feature.
### Flutter –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

#### üì± –°—Ç–∞—Ç—É—Å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º

| –§—É–Ω–∫—Ü–∏—è | Android | iOS | Windows | macOS | Linux | Web |
|---------|---------|-----|---------|-------|-------|-----|
| **P2P HTTP Server** | ‚úÖ dart:io | ‚úÖ dart:io | ‚úÖ dart:io | ‚úÖ dart:io | ‚úÖ dart:io | ‚ùå –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è CORS |
| **QR —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** | ‚úÖ mobile_scanner | ‚úÖ mobile_scanner | ‚ùå –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è | ‚úÖ mobile_scanner | ‚ùå –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è | ‚úÖ ZXing (—Ç–æ–ª—å–∫–æ QR) |
| **mDNS –ø–æ–∏—Å–∫** | ‚ö†Ô∏è –ø—Ä–æ–±–ª–µ–º—ã Android12+ | ‚úÖ multicast_dns | ‚ùå –Ω—É–∂–µ–Ω flutter_nsd | ‚úÖ multicast_dns | ‚ùå –Ω—É–∂–µ–Ω flutter_nsd | ‚ùå –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è |
| **SQLite –±–∞–∑–∞** | ‚úÖ sqflite | ‚úÖ sqflite | ‚úÖ sqflite | ‚úÖ sqflite | ‚úÖ sqflite | ‚úÖ sqflite |
| **–§–∞–π–ª—ã/–Ω–∞—Å—Ç—Ä–æ–π–∫–∏** | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |

#### üö´ iOS —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–í–ê–ñ–ù–û**: APK –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ iOS! 

**–í–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è iOS —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
1. **TestFlight** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) - –Ω—É–∂–µ–Ω Apple Developer Account ($99/–≥–æ–¥)
2. **Xcode + –∫–∞–±–µ–ª—å** - —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å Mac
3. **AltStore/Sideloadly** - –Ω–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä –∫–∞–∂–¥—ã–µ 7 –¥–Ω–µ–π

**–î–ª—è –¥—Ä—É–∑–µ–π –±–µ–∑ Mac:** –ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Web –≤–µ—Ä—Å–∏—é —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä (–Ω–æ –±–µ–∑ QR —Å–∫–∞–Ω–µ—Ä–∞).

#### üéØ –ú–∞–Ω—É–∞–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è P2P

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É:**
- Android 7.0+ (API 24+)
- 50MB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –æ–¥–Ω–æ–π —Å–µ—Ç–∏
- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è: Camera, Storage, Network

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ P2P –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏:**

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:**
   - –û–±–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –æ–¥–Ω–æ–π WiFi —Å–µ—Ç–∏
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å APK –Ω–∞ Android —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –æ–±–æ–∏—Ö

2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR –∫–æ–¥–∞ (–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ A):**
   - –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí WiFi –∏–∫–æ–Ω–∫–∞ (—Å–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É)
   - –ù–∞–∂–∞—Ç—å "–ü–æ–∫–∞–∑–∞—Ç—å QR –∫–æ–¥"
   - QR –∫–æ–¥ –ø–æ—è–≤–∏—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ

3. **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ QR –∫–æ–¥–∞ (–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ B):**
   - WiFi –∏–∫–æ–Ω–∫–∞ ‚Üí "–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å QR –∫–æ–¥"
   - –ù–∞–≤–µ—Å—Ç–∏ –∫–∞–º–µ—Ä—É –Ω–∞ QR –∫–æ–¥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ A
   - –ü–æ–¥–æ–∂–¥–∞—Ç—å "–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ [–ò–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞]"

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:**
   - –ù–∞ –æ–±–æ–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö WiFi –∏–∫–æ–Ω–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Ü–∏—Ñ—Ä—É "1" (–Ω–∞–π–¥–µ–Ω–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤)
   - –í –ª–æ–≥–∞—Ö: "P2P Server started on [IP]:[PORT]"
   - –í –ª–æ–≥–∞—Ö: "Device registered: [–Ω–∞–∑–≤–∞–Ω–∏–µ] at [IP]:[PORT]"

5. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:**
   - –°–æ–∑–¥–∞—Ç—å —Å–∫–ª–∞–¥ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ A
   - –ù–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ B –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—è–≤–∏–ª—Å—è –ª–∏ —Å–∫–ª–∞–¥
   - *(–ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é, –Ω–æ HTTP endpoints —Ä–∞–±–æ—Ç–∞—é—Ç)*

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º:**
- –ï—Å–ª–∏ QR –Ω–µ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã
- –ï—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å WiFi —Å–µ—Ç—å
- –ï—Å–ª–∏ mDNS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä—è–º–æ–µ IP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

---
**–í–ê–ñ–ù–û**: –≠—Ç–æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –í–°–ï –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è. –õ—é–±—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∫–æ—Å—Ç—ã–ª–µ–π –∏–ª–∏ –æ–±—Ö–æ–¥–æ–≤ –¥–æ–ª–∂–Ω—ã —Å–≤–µ—Ä—è—Ç—å—Å—è —Å –æ–ø—ã—Ç–æ–º LocalSend –∏ –ø—Ä–∏–Ω—Ü–∏–ø–æ–º "–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç".