# Inventory OS - Development Context & Key Decisions

## –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ß–∏—Ç–∞—Ç—å –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏! üö®

### –§–∏–ª–æ—Å–æ—Ñ–∏—è –ø—Ä–æ–µ–∫—Ç–∞
**"–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è —É–∂–µ –ø—Ä–∏–¥—É–º–∞–Ω—ã –∫–µ–º-—Ç–æ"** - –∏–∑—É—á–∞–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ä–µ—à–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –∏–∑–æ–±—Ä–µ—Ç–µ–Ω–∏—è –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞.

### –†–µ–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- **–ù–ï "—Å–µ–º–µ–π–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"** - —ç—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–∞–ª–æ–≥–∏–∑–∞—Ü–∏–∏
- **–î–µ–≤–∏–∑**: "–ö–ê–¢–ê–õ–û–ì–ò–ó–ò–†–£–ô –í–°–ï–õ–ï–ù–ù–£–Æ" 
- **–¶–µ–ª—å**: –ü–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –≤—Å–µ—Ö –≤–µ—â–µ–π —Å –ò–ò —Å–æ–≤–µ—Ç–∞–º–∏ –∏ –±—É–¥—É—â–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π (—É–º–Ω—ã–π –¥–æ–º, IoT, VR/AR)
- **–ú–∞—Å—à—Ç–∞–±**: –û—Ç –ª–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–æ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –Ω–∞ 100-100000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –¢–µ–∫—É—â–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ç—É—Å

#### –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- **–¢–µ–∫—É—â–∞—è**: React + TypeScript + Vite + Capacitor
- **–ü—Ä–æ–±–ª–µ–º–∞**: Capacitor –ù–ï –ú–û–ñ–ï–¢ —Å–æ–∑–¥–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω—ã–π HTTP —Å–µ—Ä–≤–µ—Ä –Ω–∞ Android
- **–†–µ—à–µ–Ω–∏–µ**: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Flutter (–∫–∞–∫ LocalSend)

#### P2P Evolution (4 –ø–æ–ø—ã—Ç–∫–∏):
1. `simpleP2PService.ts` - BroadcastChannel (—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ)
2. `simpleQRP2PService.ts` - WebRTC –±–µ–∑ STUN (—Å–ª–æ–∂–Ω–æ, –Ω–µ–Ω–∞–¥–µ–∂–Ω–æ)
3. `localSendStyleService.ts` - Service Worker HTTP —Å–∏–º—É–ª—è—Ü–∏—è (–±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –∫–æ—Å—Ç—ã–ª—å)
4. `nativeLocalSendService.ts` - Capacitor HTTP –ø–æ–ø—ã—Ç–∫–∞ (failed to start server –Ω–∞ Android)

#### –ü–æ—Å–ª–µ–¥–Ω–∏–π APK
`inventory-os-v2.6-native-localsend.apk` - —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –Ω–∞ Capacitor

### LocalSend –∫–∞–∫ —ç—Ç–∞–ª–æ–Ω

#### –ü–æ—á–µ–º—É LocalSend?
- **–î–æ–∫–∞–∑–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ**: –º–∏–ª–ª–∏–æ–Ω—ã –∑–∞–≥—Ä—É–∑–æ–∫, —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ P2P –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
- **–¢–µ—Ö—Å—Ç–µ–∫**: Flutter + dart:io HttpServer + multicast_dns
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ù–∞—Ç–∏–≤–Ω—ã–π HTTP —Å–µ—Ä–≤–µ—Ä, –∞–≤—Ç–æ–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å

#### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã LocalSend:
1. dart:io HttpServer –Ω–∞ —Å–ª—É—á–∞–π–Ω–æ–º –ø–æ—Ä—Ç—É
2. Multicast UDP –æ–±—ä—è–≤–ª–µ–Ω–∏–µ (224.0.0.167:53317)
3. mDNS discovery –¥–ª—è –ø–æ–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
4. HTTP POST –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
5. TLS —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

#### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (Data Conflict Resolution)
**Hybrid –ø–æ–¥—Ö–æ–¥**:
1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ items** ‚Üí CRDT (UUID + timestamp, –æ–±–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è)
2. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö** ‚Üí Role + Timestamp priority
3. **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** ‚Üí Manual resolution

#### –°–∏—Å—Ç–µ–º–∞ "–í–∑—è—Ç–æ –≤ —Ä–∞–±–æ—Ç—É" (Item Locking) üîí
**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê–Ø —Ñ—É–Ω–∫—Ü–∏—è** –¥–ª—è collaborative editing:

```typescript
enum ItemState {
  AVAILABLE = 'available',      // –°–≤–æ–±–æ–¥–µ–Ω
  LOCKED = 'locked',           // –í–∑—è—Ç –≤ —Ä–∞–±–æ—Ç—É  
  PHANTOM = 'phantom',         // –§–∞–Ω—Ç–æ–º (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–¥–µ –±—ã–ª)
  TRASH_PENDING = 'trash_pending'  // –û–∂–∏–¥–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏—è
}
```

**Workflow**:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–µ—Ä–µ—Ç –ø—Ä–µ–¥–º–µ—Ç ‚Üí item –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
2. –î—Ä—É–≥–∏–µ –≤–∏–¥—è—Ç —Ñ–∞–Ω—Ç–æ–º: "üîí –í–∑—è—Ç–æ –≤ —Ä–∞–±–æ—Ç—É: UserA ‚è∞ –û—Å—Ç–∞–ª–æ—Å—å: 12 –º–∏–Ω"
3. –§–∞–Ω—Ç–æ–º –Ω–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∏–∫–æ–º—É –∫—Ä–æ–º–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞ lock'–∞
4. –¢–∞–π–º–µ—Ä 15 –º–∏–Ω—É—Ç ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ Trash ‚Üí —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞

### –Ø–∑—ã–∫–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: Ukrainian (–≤–æ–π–Ω–∞ —Å –†–æ—Å—Å–∏–µ–π, –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- **–†—É—Å—Å–∫–∏–π**: –ö–∞–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –Ω–æ –ù–ï –∫–∞–∫ –≤–∞–ª—é—Ç–∞
- **–ò–∑–±–µ–≥–∞—Ç—å**: –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏ —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ –∏–∑-–∑–∞ —Ç–µ–∫—É—â–∏—Ö —Å–æ–±—ã—Ç–∏–π

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

#### Capacitor –ø—Ä–æ–±–ª–µ–º—ã:
- –ë—É—Ñ–µ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ APK –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ (WebView initialization)
- –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è React + —Å–µ—Ä–≤–∏—Å–æ–≤
- localStorage –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ Android –º–µ–¥–ª–µ–Ω–Ω–µ–µ
- –ö–Ω–æ–ø–∫–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã –ø–æ–∫–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∞—Ç—Å—è useEffect —Ö—É–∫–∏

#### Flutter –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- –ù–∞—Ç–∏–≤–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è ‚Üí –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç
- –ù–∞—Å—Ç–æ—è—â–∏–π HTTP —Å–µ—Ä–≤–µ—Ä (dart:io)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ WebView overhead
- –ï–¥–∏–Ω—ã–π –∫–æ–¥ –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (—á—Ç–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å –≤ Flutter)

#### Core:
- Multi-level organization (Warehouses‚ÜíRooms‚ÜíShelves‚ÜíItems)
- Offline-first —Å localStorage
- Multi-currency & multi-language
- Import/Export (JSON, CSV)
- User management —Å role-based access
- Trash management —Å soft delete

#### AI Integration:
- Multiple providers (Claude, OpenAI, Local LLM)
- Chat interface –¥–ª—è natural language queries
- Barcode scanning
- Smart recommendations

#### P2P Features:
- QR code pairing (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –¥–æ 3 –∫–Ω–æ–ø–æ–∫)
- Network discovery simulation
- Conflict resolution
- SimpleQRModal —Å —Ä–µ–∞–ª—å–Ω—ã–º QR —Å–∫–∞–Ω–µ—Ä–æ–º (qr-scanner lib)

### –û—à–∏–±–∫–∏ –∫–æ—Ç–æ—Ä—ã—Ö –∏–∑–±–µ–≥–∞—Ç—å

#### ‚ùå –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è –±–µ–∑ –∏–∑—É—á–µ–Ω–∏—è –∞–Ω–∞–ª–æ–≥–æ–≤
2. –ö–æ—Å—Ç—ã–ª–∏ –≤–º–µ—Å—Ç–æ —Å–º–µ–Ω—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã  
3. Service Worker –∫–∞–∫ HTTP —Å–µ—Ä–≤–µ—Ä
4. WebRTC –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á
5. "–°–µ–º–µ–π–Ω–æ–µ" –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ

#### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:
1. –ò–∑—É—á–µ–Ω–∏–µ LocalSend –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º
2. Flutter + dart:io –¥–ª—è –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ networking
3. CRDT + Role-based conflict resolution
4. Item locking —Å–∏—Å—Ç–µ–º–∞
5. –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–æ–¥–∞—á–∞ –ø—Ä–æ–µ–∫—Ç–∞

### Flutter Migration Plan

#### Phase 1: Platform Migration
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Flutter SDK
- `flutter create inventory_os_flutter`
- –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å UI (React ‚Üí Flutter widgets)
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å dart:io HttpServer
- –î–æ–±–∞–≤–∏—Ç—å multicast_dns –¥–ª—è discovery

#### Key Packages:
```yaml
dependencies:
  mobile_scanner: ^4.0.1      # QR —Å–∫–∞–Ω–µ—Ä
  multicast_dns: ^0.3.2       # Device discovery  
  http: ^1.1.0                 # HTTP –∫–ª–∏–µ–Ω—Ç
  # dart:io –≤—Å—Ç—Ä–æ–µ–Ω –¥–ª—è HTTP —Å–µ—Ä–≤–µ—Ä–∞
```

#### Phase 2-4: Enhanced features
- AI integration —É–ª—É—á—à–µ–Ω–∏—è
- IoT integration  
- Enterprise scalability
- AR/VR interfaces (–¥–∞–ª–µ–∫–æ–µ –±—É–¥—É—â–µ–µ)

### –ú–∞–Ω—Ç—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞
- "–õ–∏–±–æ –Ω–∞–π–¥–µ–º –∫–∞–∫ —Å–¥–µ–ª–∞–ª –∫—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–π, –ª–∏–±–æ –ø–æ–π–º–µ–º –ø–æ—á–µ–º—É –Ω–∏–∫—Ç–æ —Ç–∞–∫ –Ω–µ –¥–µ–ª–∞–µ—Ç"
- "–ù–µ –∏–∑–æ–±—Ä–µ—Ç–∞–µ–º –≤–µ–ª–æ—Å–∏–ø–µ–¥. –ò–∑—É—á–∞–µ–º —á—É–∂–∏–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥—ã –∏ –¥–µ–ª–∞–µ–º —Å–≤–æ–π –º–æ—Ç–æ—Ü–∏–∫–ª"
- "–ò–∑—É—á–µ–Ω–∏–µ –∞–Ω–∞–ª–æ–≥–æ–≤ —ç–∫–æ–Ω–æ–º–∏—Ç –Ω–µ–¥–µ–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"

---

**–í–ê–ñ–ù–û**: –≠—Ç–æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –í–°–ï –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è. –õ—é–±—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∫–æ—Å—Ç—ã–ª–µ–π –∏–ª–∏ –æ–±—Ö–æ–¥–æ–≤ –¥–æ–ª–∂–Ω—ã —Å–≤–µ—Ä—è—Ç—å—Å—è —Å –æ–ø—ã—Ç–æ–º LocalSend –∏ –ø—Ä–∏–Ω—Ü–∏–ø–æ–º "–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç".